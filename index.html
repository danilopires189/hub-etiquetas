<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hub de Etiquetas CDs— Ícones</title>
  <style>
    :root{
      --bg:#f5f8ff; --card:#ffffff; --muted:#4b5563; --text:#0b1220;
      --brand:#2563eb; --brand-2:#0ea5e9; --ring:#2563eb33; --ink:#0f172a;
      --radius:18px;
    }
    @media (prefers-color-scheme: dark){
      :root{ --bg:#0b0f1a; --card:#0f1524; --muted:#94a3b8; --text:#e5edff; --ring:#3b82f633; --ink:#e5edff; }
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0; font-family: ui-sans-serif,system-ui,Segoe UI,Arial,sans-serif;
      color: var(--text);
      background: linear-gradient(180deg,#eef3ff 0%, #fff 60%);
    }
    @media (prefers-color-scheme: dark){ 
      body{ background: linear-gradient(180deg,#081022 0%, #0b0f1a 60%);} 
    }

    header{
      position: sticky; top:0; z-index: 20;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:14px 18px; background: rgba(255,255,255,.75); backdrop-filter: blur(6px);
      border-bottom: 1px solid #e5e7eb;
    }
    @media (prefers-color-scheme: dark){ header{ background: rgba(7,12,25,.6); border-bottom-color:#21304d; } }
    .brand{ display:flex; align-items:center; gap:12px; min-width:0; }
    .logos{ display:flex; align-items:center; gap:10px; }
    .logos img{ height:28px; width:auto; object-fit:contain; }
    .brand h1{ font-size:16px; margin:0; letter-spacing:.2px; white-space:nowrap; }
    .brand .sub{ display:block; font-size:12px; color:var(--muted); }

    .ghost{ appearance:none; border:1px solid #c7d2fe; background:#eef2ff; color:#1e2a78; padding:8px 12px; border-radius:10px; font-weight:600; cursor:pointer; white-space:nowrap; }
    .ghost[hidden]{ display:none; }
    @media (prefers-color-scheme: dark){ .ghost{ border-color:#334155; background:#0b1220; color:#e5edff; } }

    main{ max-width:1200px; margin:0 auto; padding:18px; }

    .chooser h2{ margin:8px 0 16px; font-size:18px; color:var(--ink); }
    .grid{
      display:grid; grid-template-columns: repeat(auto-fill, minmax(230px,1fr)); gap:18px;
    }

    .tile{
      position:relative; isolation:isolate;
      display:flex; flex-direction:column; gap:10px;
      padding:16px; border-radius: var(--radius);
      background: var(--card);
      border:1px solid #e2e8f0; cursor:pointer; text-align:left;
      transition: transform .2s ease, box-shadow .2s ease, border-color .2s ease;
      overflow:hidden;
    }
    .tile:hover, .tile:focus-visible{ 
      transform: translateY(-4px);
      border-color:#b6c5ff; 
      box-shadow: 0 20px 40px rgba(37,99,235,.12), 0 0 0 6px var(--ring);
      outline:none;
    }

    .icon-wrap{
      width:64px; height:64px; border-radius:18px;
      background: linear-gradient(135deg, var(--brand), var(--brand-2));
      display:grid; place-items:center;
      box-shadow: 0 12px 20px rgba(37,99,235,.25);
      animation: float 3.2s ease-in-out infinite;
    }
    @keyframes float{
      0%,100%{ transform: translateY(0px); }
      50%{ transform: translateY(-6px); }
    }
    .icon-wrap svg{ width:34px; height:34px; color:#fff; }

    .tile .title{ font-weight:800; font-size:16px; }
    .tile .muted{ font-size:13px; color:var(--muted); }

    .badge{
      position:absolute; right:12px; top:12px; 
      font-size:11px; font-weight:700; letter-spacing:.2px;
      padding:4px 8px; border-radius:999px;
      background:linear-gradient(135deg,var(--brand),var(--brand-2)); 
      color:white;
    }

    .viewer{ margin-top:10px; }
    .viewer[hidden], .hidden{ display:none; }
    .frame-wrap{ border:1px solid #e2e8f0; border-radius: var(--radius); overflow:hidden; background:#00000008; }
    iframe{ width:100%; height: calc(100vh - 150px); border:0; background:white; display:block; }

    .toolbar{ display:flex; gap:10px; align-items:center; justify-content:flex-end; padding:10px 0; }
    .btn{ appearance:none; border:1px solid #00000020; background:var(--card); color:inherit; padding:10px 14px; border-radius:12px; display:flex; gap:8px; align-items:center; cursor:pointer; }
    .btn:hover{ border-color:#00000040; }
    .btn svg{ width:16px; height:16px; }

    .help{ margin-top:10px; font-size:12px; color:var(--muted); }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="logos">
        <img src="./assets/logo_pm.svg" alt="Pague Menos" onerror="this.style.display='none'">
        <img src="./assets/logo_secundario.svg" alt="" onerror="this.style.display='none'">
      </div>
      <div>
        <h1>Hub de Etiquetas - CDs</h1>
        <span class="sub">Caixa • Endereçamento • Produto • Volume Avulso • Transferência • Termolábeis</span>
      </div>
    </div>
    <button id="btnHome" class="ghost" hidden>Trocar aplicação</button>
  </header>

  <main>
    <section id="chooser" class="chooser">
      <h2>Escolha a aplicação</h2>
      <div id="apps" class="grid" role="list"></div>
      <p class="help">Dica: use <strong>Ctrl+1…6</strong> para abrir rápido. Você pode voltar clicando em <em>Trocar aplicação</em>.</p>
    </section>

    <section id="viewer" class="viewer hidden" aria-live="polite">
      <div class="toolbar">
        <button id="btnNewTab" class="btn" title="Abrir em nova aba">
          <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M14 3h7v7h-2V6.41l-9.29 9.3-1.42-1.42 9.3-9.29H14V3zM5 5h6v2H7v10h10v-4h2v6H5V5z"/>
          </svg>
          Abrir em nova aba
        </button>
      </div>
      <div class="frame-wrap">
        <iframe id="appFrame" title="Aplicação selecionada" loading="eager" referrerpolicy="no-referrer"></iframe>
      </div>
    </section>
  </main>

  <script>
    // ===== Definição dos apps: caminhos que você JÁ usa =====
    const APPS = [
      { id:'placas',  name:'Etiquetas de Produto', desc:'Códigos de barras com legenda', path:'./placas/',  hotkey:'1', icon:'barcode' },
      { id:'caixa',   name:'Etiquetas de Caixa',   desc:'Caixa padrão azul | Rotulagem',  path:'./caixa/',   hotkey:'2', icon:'box' },
      { id:'avulso',  name:'Volume Avulso',        desc:'Etiqueta por volume',       path:'./avulso/',  hotkey:'3', icon:'layers' },
      { id:'enderec', name:'Endereçamento',        desc:'Etiquetas de endereço | Inventário',     path:'./enderec/', hotkey:'4', icon:'map' },
      { id:'transfer',name:'Transferência CD → CD',desc:'Documento A4',              path:'./transferencia/', hotkey:'5', icon:'truck' },
      { id:'termo',   name:'Termolábeis',          desc:'Módulo de Termo',           path:'./termo/',   hotkey:'6', icon:'thermo' },
    ];

    // ===== Ícones inline (sem dependência externa) =====
    const ICONS = {
      box: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 7l9 4 9-4"/><path d="M3 7l9-4 9 4v10l-9 4-9-4z"/></svg>',
      barcode: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 6v12"/><path d="M7 6v12"/><path d="M10 6v12"/><path d="M12 6v12"/><path d="M15 6v12"/><path d="M18 6v12"/><path d="M20 6v12"/></svg>',
      layers: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2l9 5-9 5-9-5 9-5z"/><path d="M3 12l9 5 9-5"/><path d="M3 17l9 5 9-5"/></svg>',
      map: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 6l7-3 8 3 7-3v15l-7 3-8-3-7 3z"/><path d="M8 3v15"/><path d="M16 6v15"/></svg>',
      truck: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 7h12v8H3z"/><path d="M15 10h4l2 3v2h-6z"/><circle cx="7.5" cy="17.5" r="2.5"/><circle cx="17.5" cy="17.5" r="2.5"/></svg>',
      thermo: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2a2 2 0 0 1 2 2v8a5 5 0 1 1-4 0V4a2 2 0 0 1 2-2z"/><path d="M12 9v8"/></svg>',
    };

    const $ = (s)=>document.querySelector(s);
    const grid = $('#apps');
    const chooser = $('#chooser');
    const viewer = $('#viewer');
    const frame = $('#appFrame');
    const btnHome = $('#btnHome');
    const btnNewTab = $('#btnNewTab');
    let currentApp = null;

    // ===================== NOVO: Sempre iniciar no Hub =====================
    const ALWAYS_START_IN_HUB = true; // deixe true para sempre abrir no Hub
    // =======================================================================

    function tileHTML(app){
      const icon = ICONS[app.icon] || ICONS.box;
      return (
        '<button class="tile" data-id="'+app.id+'" data-path="'+app.path+'" role="listitem" aria-label="'+app.name+'">'+
          '<span class="icon-wrap">'+ icon +'</span>'+
          '<span class="title">'+ app.name +'</span>'+
          '<span class="muted">'+ (app.desc||'') +'</span>'+
          '<span class="badge">Ctrl+'+(app.hotkey||'')+'</span>'+
        '</button>'
      );
    }

    function renderTiles(){
      try{
        grid.innerHTML = APPS.map(tileHTML).join('');
      }catch(e){
        console.error('Erro ao renderizar cards', e);
      }
    }

    function openById(id){
      const app = APPS.find(a => a.id === id);
      if(!app) return;
      currentApp = app;
      const url = app.path.endsWith('/') ? app.path + 'index.html' : app.path;
      frame.src = url;
      chooser.classList.add('hidden');
      viewer.classList.remove('hidden');
      btnHome.hidden = false;
      // Mantemos o hash e o lastApp, mas o boot() pode ignorá-los se ALWAYS_START_IN_HUB=true
      window.scrollTo({ top: 0, behavior: 'smooth' });
      setTimeout(()=> frame.focus(), 80);
    }

    grid.addEventListener('click', (ev)=>{
      const tile = ev.target.closest('.tile');
      if(!tile) return;
      openById(tile.dataset.id);
    });

    btnHome.addEventListener('click', ()=>{
      frame.src = '';
      viewer.classList.add('hidden');
      chooser.classList.remove('hidden');
      btnHome.hidden = true;
      currentApp = null;
    });

    btnNewTab.addEventListener('click', ()=>{
      if(currentApp){
        const url = currentApp.path.endsWith('/') ? currentApp.path + 'index.html' : currentApp.path;
        window.open(url, '_blank', 'noopener');
      }
    });

    // Hotkeys Ctrl+1..6
    document.addEventListener('keydown', (ev)=>{
      const isCtrl = ev.ctrlKey || ev.metaKey;
      if(!isCtrl) return;
      const hit = APPS.find(a => a.hotkey === ev.key);
      if(hit){ ev.preventDefault(); openById(hit.id); }
    });

    function boot(){
      renderTiles();
      // =================== AJUSTE: SEMPRE INICIAR NO HUB ===================
      if (ALWAYS_START_IN_HUB) {
        // Ignora hash e último app salvo, mantendo só o Hub visível
        btnHome.hidden = true;
        viewer.classList.add('hidden');
        chooser.classList.remove('hidden');
        frame.src = '';
        return;
      }
      // (Sem histórico): não lemos hash nem localStorage; sempre inicia no Hub.

    }
    boot();
  </script>
</body>
</html>
