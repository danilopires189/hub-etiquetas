<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - Quantidade >= 8</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .test-result { margin: 10px 0; padding: 10px; background: #f5f5f5; border-radius: 3px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        .warning { background: #fff3cd; color: #856404; }
        .sequence-demo { display: grid; grid-template-columns: repeat(8, 1fr); gap: 5px; margin: 15px 0; font-size: 12px; }
        .label-demo { 
            border: 1px solid #333; 
            padding: 8px; 
            text-align: center; 
            font-weight: bold; 
            background: white;
        }
        .correct { border-color: #28a745; background: #d4edda; }
        .incorrect { border-color: #dc3545; background: #f8d7da; }
        .repeated { border-color: #ffc107; background: #fff3cd; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 3px; cursor: pointer; }
        button:hover { background: #0056b3; }
    </style>
</head>
<body>
    <h1>🚨 Teste - Problema com Quantidade >= 8</h1>
    
    <div class="test-section">
        <h2>🔍 Problema Específico Identificado</h2>
        <div class="test-result error">
            <p><strong>Condição do Erro:</strong></p>
            <ul>
                <li>✅ Quantidade >= 8</li>
                <li>✅ Tipo = "Somente Interna"</li>
                <li>✅ Qualquer quantidade de cópias</li>
            </ul>
            <p><strong>Sintoma:</strong> A partir da 8ª quantidade, a sequência começa a se repetir</p>
        </div>
    </div>

    <div class="test-section">
        <h2>❌ Sequência Incorreta (Da Imagem)</h2>
        <div class="test-result error">
            <p><strong>Base: 082545, Quantidade: 8, Cópias: 2</strong></p>
            <p><strong>Sequência Observada (Incorreta):</strong></p>
            <div class="sequence-demo">
                <div class="label-demo correct">2545</div>
                <div class="label-demo correct">2545</div>
                <div class="label-demo correct">2546</div>
                <div class="label-demo correct">2546</div>
                <div class="label-demo correct">2547</div>
                <div class="label-demo correct">2547</div>
                <div class="label-demo correct">2548</div>
                <div class="label-demo correct">2548</div>
                <div class="label-demo correct">2549</div>
                <div class="label-demo correct">2549</div>
                <div class="label-demo correct">2550</div>
                <div class="label-demo correct">2550</div>
                <div class="label-demo correct">2551</div>
                <div class="label-demo correct">2551</div>
                <div class="label-demo correct">2552</div>
                <div class="label-demo correct">2552</div>
                <div class="label-demo repeated">2550</div>
                <div class="label-demo repeated">2550</div>
                <div class="label-demo repeated">2551</div>
                <div class="label-demo repeated">2551</div>
                <div class="label-demo repeated">2552</div>
                <div class="label-demo repeated">...</div>
            </div>
            <p>❌ <strong>Problema:</strong> Após as 16 primeiras etiquetas corretas, começa a repetir 2550, 2551, 2552...</p>
        </div>
    </div>

    <div class="test-section">
        <h2>✅ Sequência Correta Esperada</h2>
        <div class="test-result success">
            <p><strong>Base: 082545, Quantidade: 8, Cópias: 2 = 16 etiquetas</strong></p>
            <div class="sequence-demo">
                <div class="label-demo correct">2545</div>
                <div class="label-demo correct">2545</div>
                <div class="label-demo correct">2546</div>
                <div class="label-demo correct">2546</div>
                <div class="label-demo correct">2547</div>
                <div class="label-demo correct">2547</div>
                <div class="label-demo correct">2548</div>
                <div class="label-demo correct">2548</div>
                <div class="label-demo correct">2549</div>
                <div class="label-demo correct">2549</div>
                <div class="label-demo correct">2550</div>
                <div class="label-demo correct">2550</div>
                <div class="label-demo correct">2551</div>
                <div class="label-demo correct">2551</div>
                <div class="label-demo correct">2552</div>
                <div class="label-demo correct">2552</div>
            </div>
            <p>✅ <strong>Total:</strong> Exatamente 16 etiquetas, sem repetições!</p>
        </div>
    </div>

    <div class="test-section">
        <h2>🔧 Correção Implementada</h2>
        <div class="test-result success">
            <h3>🚨 Modo Anti-Repetição Ativado</h3>
            <ul>
                <li>Limpeza completa do preview antes de começar</li>
                <li>Reset do contador de operações</li>
                <li>Controle rigoroso da sequência com array de debug</li>
                <li>Verificação de integridade no final</li>
                <li>Logs detalhados para cada etapa</li>
                <li>Delay reduzido para evitar problemas de timing</li>
            </ul>
        </div>
    </div>

    <div class="test-section">
        <h2>🧪 Cenários de Teste</h2>
        
        <div class="test-result warning">
            <h3>Teste 1: Quantidade = 7 (Deve Funcionar)</h3>
            <p><strong>Config:</strong> Base: 1000, Qtd: 7, Cópias: 2, Tipo: Interna</p>
            <p><strong>Esperado:</strong> 14 etiquetas (1000 até 1006, 2 cópias cada)</p>
            <button onclick="testarQtd7()">🧪 Testar Qtd = 7</button>
        </div>

        <div class="test-result error">
            <h3>Teste 2: Quantidade = 8 (Problema Original)</h3>
            <p><strong>Config:</strong> Base: 082545, Qtd: 8, Cópias: 2, Tipo: Interna</p>
            <p><strong>Esperado:</strong> 16 etiquetas (2545 até 2552, 2 cópias cada)</p>
            <button onclick="testarQtd8()">🧪 Testar Qtd = 8</button>
        </div>

        <div class="test-result error">
            <h3>Teste 3: Quantidade = 10 (Teste Maior)</h3>
            <p><strong>Config:</strong> Base: 3000, Qtd: 10, Cópias: 1, Tipo: Interna</p>
            <p><strong>Esperado:</strong> 10 etiquetas (3000 até 3009)</p>
            <button onclick="testarQtd10()">🧪 Testar Qtd = 10</button>
        </div>
    </div>

    <div class="test-section">
        <h2>🔍 Como Verificar a Correção</h2>
        <ol>
            <li>Abra a aplicação caixa (index.html)</li>
            <li>Configure: Base: 082545, Quantidade: 8, Cópias: 2</li>
            <li>Selecione "Somente Interna"</li>
            <li>Abra o Console (F12) ANTES de gerar</li>
            <li>Clique em "Gerar"</li>
            <li>Observe no console:</li>
            <ul>
                <li>"🚨 MODO ANTI-REPETIÇÃO ATIVADO"</li>
                <li>"✅ VERIFICAÇÃO OK: Quantidade correta!"</li>
                <li>Sequência final sem repetições</li>
            </ul>
            <li>Conte visualmente: deve ter exatamente 16 etiquetas</li>
        </ol>
    </div>

    <script>
        function testarQtd7() {
            alert('🧪 TESTE QUANTIDADE = 7\\n\\nConfigure na aplicação:\\n\\nBase: 1000\\nQuantidade: 7\\nCópias: 2\\nTipo: Somente Interna\\n\\n✅ Esperado: 14 etiquetas\\nSequência: 1000, 1000, 1001, 1001, ..., 1006, 1006\\n\\n📝 Este deve funcionar normalmente');
        }

        function testarQtd8() {
            alert('🧪 TESTE QUANTIDADE = 8 (PROBLEMA ORIGINAL)\\n\\nConfigure na aplicação:\\n\\nBase: 082545\\nQuantidade: 8\\nCópias: 2\\nTipo: Somente Interna\\n\\n✅ Esperado: 16 etiquetas\\nSequência: 2545, 2545, 2546, 2546, ..., 2552, 2552\\n\\n🔍 Observe o console para "MODO ANTI-REPETIÇÃO"!');
        }

        function testarQtd10() {
            alert('🧪 TESTE QUANTIDADE = 10 (MAIOR)\\n\\nConfigure na aplicação:\\n\\nBase: 3000\\nQuantidade: 10\\nCópias: 1\\nTipo: Somente Interna\\n\\n✅ Esperado: 10 etiquetas\\nSequência: 3000, 3001, 3002, ..., 3009\\n\\n📊 Teste de stress para quantidades maiores');
        }
    </script>

</body>
</html>