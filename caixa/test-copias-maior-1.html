<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - C√≥pias > 1</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .test-result { margin: 10px 0; padding: 10px; background: #f5f5f5; border-radius: 3px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        .warning { background: #fff3cd; color: #856404; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 3px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .code-block { background: #f8f9fa; padding: 15px; border-left: 4px solid #dc3545; margin: 15px 0; font-family: monospace; white-space: pre-wrap; }
    </style>
</head>
<body>
    <h1>üêõ Teste - Problema com C√≥pias > 1 (Etiquetas Internas)</h1>
    
    <div class="test-section">
        <h2>üîç Problema Espec√≠fico Identificado</h2>
        <div class="test-result error">
            <p><strong>Condi√ß√µes do Erro:</strong></p>
            <ul>
                <li>‚úÖ Quantidade de c√≥pias > 1</li>
                <li>‚úÖ Tipo = "Somente Interna"</li>
            </ul>
            <p><strong>Sintoma:</strong> Sequ√™ncia incorreta quando h√° mais de 1 c√≥pia por n√∫mero</p>
        </div>
    </div>

    <div class="test-section">
        <h2>üß™ Cen√°rios de Teste Espec√≠ficos</h2>
        
        <div class="test-result warning">
            <h3>Teste 1: C√≥pias = 1 (Deve Funcionar)</h3>
            <p><strong>Config:</strong> Base: 1000, Qtd: 3, C√≥pias: 1, Tipo: Interna</p>
            <p><strong>Esperado:</strong> 1000, 1001, 1002</p>
            <button onclick="testarCopias1()">üß™ Testar C√≥pias = 1</button>
        </div>

        <div class="test-result error">
            <h3>Teste 2: C√≥pias = 2 (Problema)</h3>
            <p><strong>Config:</strong> Base: 1000, Qtd: 3, C√≥pias: 2, Tipo: Interna</p>
            <p><strong>Esperado:</strong> 1000, 1000, 1001, 1001, 1002, 1002</p>
            <button onclick="testarCopias2()">üß™ Testar C√≥pias = 2</button>
        </div>

        <div class="test-result error">
            <h3>Teste 3: C√≥pias = 3 (Problema)</h3>
            <p><strong>Config:</strong> Base: 2000, Qtd: 2, C√≥pias: 3, Tipo: Interna</p>
            <p><strong>Esperado:</strong> 2000, 2000, 2000, 2001, 2001, 2001</p>
            <button onclick="testarCopias3()">üß™ Testar C√≥pias = 3</button>
        </div>
    </div>

    <div class="test-section">
        <h2>üîß Simula√ß√£o da L√≥gica</h2>
        <div class="test-result info">
            <p>Vamos simular exatamente o que deveria acontecer:</p>
            <button onclick="simularLogica()">‚ñ∂Ô∏è Simular L√≥gica Correta</button>
            <div id="simulacao-resultado" class="code-block" style="display: none;"></div>
        </div>
    </div>

    <div class="test-section">
        <h2>üìã Instru√ß√µes para Debug</h2>
        <ol>
            <li>Abra a aplica√ß√£o caixa (index.html)</li>
            <li>Configure: Base: 1000, Quantidade: 3, C√≥pias: 2</li>
            <li>Selecione "Somente Interna"</li>
            <li>Abra o Console (F12) ANTES de clicar "Gerar"</li>
            <li>Clique em "Gerar" e observe os logs</li>
            <li>Compare com a simula√ß√£o abaixo</li>
            <li>Anote exatamente qual sequ√™ncia est√° sendo gerada</li>
        </ol>
    </div>

    <script>
        const padLeft = (numStr, len) => (Array(len + 1).join('0') + numStr).slice(-len);

        function testarCopias1() {
            alert('üß™ TESTE C√ìPIAS = 1\\n\\nConfigure na aplica√ß√£o:\\n\\nBase: 1000\\nQuantidade: 3\\nC√≥pias: 1\\nTipo: Somente Interna\\n\\n‚úÖ Esperado: 1000, 1001, 1002\\n\\nüìù Este deve funcionar normalmente');
        }

        function testarCopias2() {
            alert('üß™ TESTE C√ìPIAS = 2 (PROBLEMA)\\n\\nConfigure na aplica√ß√£o:\\n\\nBase: 1000\\nQuantidade: 3\\nC√≥pias: 2\\nTipo: Somente Interna\\n\\n‚úÖ Esperado: 1000, 1000, 1001, 1001, 1002, 1002\\n\\n‚ö†Ô∏è Observe se a sequ√™ncia est√° correta!');
        }

        function testarCopias3() {
            alert('üß™ TESTE C√ìPIAS = 3 (PROBLEMA)\\n\\nConfigure na aplica√ß√£o:\\n\\nBase: 2000\\nQuantidade: 2\\nC√≥pias: 3\\nTipo: Somente Interna\\n\\n‚úÖ Esperado: 2000, 2000, 2000, 2001, 2001, 2001\\n\\n‚ö†Ô∏è Verifique se todas as 6 etiquetas est√£o corretas!');
        }

        function simularLogica() {
            const resultado = document.getElementById('simulacao-resultado');
            resultado.style.display = 'block';
            
            // Par√¢metros do teste problem√°tico
            const base = '1000';
            const qtd = 3;
            const copias = 2;
            const len = base.length;
            
            let log = '';
            log += `üß™ SIMULA√á√ÉO - C√ìPIAS > 1 (PROBLEMA)\\n`;
            log += `==========================================\\n\\n`;
            log += `Par√¢metros:\\n`;
            log += `- base: "${base}"\\n`;
            log += `- qtd: ${qtd}\\n`;
            log += `- copias: ${copias} (> 1 - AQUI EST√Å O PROBLEMA)\\n`;
            log += `- len: ${len}\\n\\n`;
            
            let etiquetas = [];
            let totalEtiquetas = 0;
            
            // Simular a l√≥gica atual
            log += `SIMULA√á√ÉO DA L√ìGICA ATUAL:\\n`;
            log += `for (i = 0; i < ${qtd}; i++)\\n\\n`;
            
            for (let i = 0; i < qtd; i++) {
                log += `--- N√öMERO ${i + 1}/${qtd} ---\\n`;
                log += `i = ${i}\\n`;
                
                const atual = padLeft(String(parseInt(base, 10) + i), len);
                log += `atual = padLeft(String(${parseInt(base, 10)} + ${i}), ${len}) = "${atual}"\\n`;
                
                const numeroInterno = atual.length >= 4 ? atual.slice(-4) : atual;
                log += `numeroInterno = "${atual}".slice(-4) = "${numeroInterno}"\\n\\n`;
                
                log += `  LOOP DE C√ìPIAS (${copias} c√≥pias):\\n`;
                for (let c = 0; c < copias; c++) {
                    totalEtiquetas++;
                    etiquetas.push(numeroInterno);
                    log += `    c = ${c}: Gerando "${numeroInterno}" (etiqueta #${totalEtiquetas})\\n`;
                }
                log += `\\n`;
            }
            
            log += `==========================================\\n`;
            log += `RESULTADO DA SIMULA√á√ÉO:\\n`;
            log += `Total: ${totalEtiquetas} etiquetas\\n`;
            log += `Sequ√™ncia: [${etiquetas.join(', ')}]\\n\\n`;
            
            // Verifica√ß√£o
            const esperado = ['1000', '1000', '1001', '1001', '1002', '1002'];
            const correto = JSON.stringify(etiquetas) === JSON.stringify(esperado);
            
            if (correto) {
                log += `‚úÖ SIMULA√á√ÉO CORRETA!\\n`;
                log += `A l√≥gica deveria funcionar.\\n`;
                log += `Se a aplica√ß√£o real est√° dando resultado diferente,\\n`;
                log += `pode haver problema em outro lugar do c√≥digo.`;
            } else {
                log += `‚ùå PROBLEMA NA SIMULA√á√ÉO!\\n`;
                log += `Esperado: [${esperado.join(', ')}]\\n`;
                log += `Simulado: [${etiquetas.join(', ')}]\\n`;
                log += `\\nISTO INDICA PROBLEMA NA L√ìGICA B√ÅSICA!`;
            }
            
            resultado.textContent = log;
        }
    </script>

</body>
</html>