<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Sequ√™ncia - Modo AMBAS</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .debug-output { 
            background: #f5f5f5; 
            padding: 15px; 
            margin: 10px 0; 
            border-radius: 5px; 
            font-family: monospace;
            white-space: pre-line;
        }
        .test-case { 
            border: 1px solid #ddd; 
            margin: 10px 0; 
            padding: 15px; 
            border-radius: 5px; 
        }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>üêõ Debug Sequ√™ncia - Modo AMBAS</h1>
    
    <div class="test-case">
        <h3>Teste: Base 082547, 3 n√∫meros, 2 c√≥pias</h3>
        <p>Sequ√™ncia esperada:</p>
        <ul>
            <li>082547 (externa) - c√≥pia 1</li>
            <li>082547 (externa) - c√≥pia 2</li>
            <li>2547 (interna) - c√≥pia 1</li>
            <li>2547 (interna) - c√≥pia 2</li>
            <li>082548 (externa) - c√≥pia 1</li>
            <li>082548 (externa) - c√≥pia 2</li>
            <li>2548 (interna) - c√≥pia 1</li>
            <li>2548 (interna) - c√≥pia 2</li>
            <li>082549 (externa) - c√≥pia 1</li>
            <li>082549 (externa) - c√≥pia 2</li>
            <li>2549 (interna) - c√≥pia 1</li>
            <li>2549 (interna) - c√≥pia 2</li>
        </ul>
        <button onclick="debugSequence()">Executar Debug</button>
        <div id="debug-output" class="debug-output"></div>
    </div>

    <script>
        const padLeft = (numStr, len) => (Array(len + 1).join('0') + numStr).slice(-len);
        
        function debugSequence() {
            const base = '082547';
            const qtd = 3;
            const copias = 2;
            const len = base.length;
            
            let output = `Debug: Base=${base}, Qtd=${qtd}, C√≥pias=${copias}\n\n`;
            let sequenceOrder = [];
            
            console.log('üêõ Iniciando debug da sequ√™ncia...');
            
            for (let i = 0; i < qtd; i++) {
                const atual = padLeft(String(parseInt(base, 10) + i), len);
                const payloadBase = (atual.length % 2 === 0) ? atual : ('0' + atual);
                const last4 = atual.length >= 4 ? atual.slice(-4) : atual;
                
                output += `--- N√∫mero ${i} ---\n`;
                output += `atual: ${atual}\n`;
                output += `payloadBase: ${payloadBase}\n`;
                output += `last4: ${last4}\n\n`;
                
                console.log(`Debug n√∫mero ${i}: atual=${atual}, payloadBase=${payloadBase}, last4=${last4}`);
                
                // PRIMEIRO: Etiquetas externas deste n√∫mero
                for (let c = 0; c < copias; c++) {
                    const etiqueta = `${payloadBase} (externa-${c+1})`;
                    sequenceOrder.push(etiqueta);
                    output += `  ‚Üí EXTERNA ${i}-${c}: ${payloadBase}\n`;
                    console.log(`üè∑Ô∏è Gerando EXTERNA ${i}-${c}: ${payloadBase}`);
                }
                
                // DEPOIS: Etiquetas internas do MESMO n√∫mero
                for (let k = 0; k < 2; k++) {
                    const etiqueta = `${last4} (interna-${k+1})`;
                    sequenceOrder.push(etiqueta);
                    output += `  ‚Üí INTERNA ${i}-${k}: ${last4}\n`;
                    console.log(`üè∑Ô∏è Gerando INTERNA ${i}-${k}: ${last4}`);
                }
                
                output += '\n';
            }
            
            output += '=== SEQU√äNCIA FINAL ===\n';
            sequenceOrder.forEach((item, index) => {
                output += `${index + 1}. ${item}\n`;
            });
            
            // Verificar se a sequ√™ncia est√° correta
            const expectedSequence = [
                '082547 (externa-1)', '082547 (externa-2)', '2547 (interna-1)', '2547 (interna-2)',
                '082548 (externa-1)', '082548 (externa-2)', '2548 (interna-1)', '2548 (interna-2)',
                '082549 (externa-1)', '082549 (externa-2)', '2549 (interna-1)', '2549 (interna-2)'
            ];
            
            let isCorrect = true;
            for (let i = 0; i < expectedSequence.length; i++) {
                if (sequenceOrder[i] !== expectedSequence[i]) {
                    isCorrect = false;
                    output += `\n‚ùå ERRO na posi√ß√£o ${i + 1}:\n`;
                    output += `  Esperado: ${expectedSequence[i]}\n`;
                    output += `  Obtido: ${sequenceOrder[i]}\n`;
                }
            }
            
            if (isCorrect) {
                output += '\n‚úÖ SEQU√äNCIA CORRETA!';
            } else {
                output += '\n‚ùå SEQU√äNCIA INCORRETA!';
            }
            
            document.getElementById('debug-output').textContent = output;
        }
        
        // Executar automaticamente
        window.addEventListener('load', () => {
            setTimeout(debugSequence, 500);
        });
    </script>
</body>
</html>