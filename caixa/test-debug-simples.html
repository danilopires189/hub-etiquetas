<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Debug Simples</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-box { padding: 20px; border: 2px solid #007bff; border-radius: 10px; margin: 20px 0; }
        .result { margin: 15px 0; padding: 15px; background: #f8f9fa; border-radius: 5px; font-family: monospace; white-space: pre-wrap; }
        button { padding: 15px 30px; font-size: 16px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; margin: 10px; }
        button:hover { background: #0056b3; }
    </style>
</head>
<body>
    <h1>üîç Teste Debug Simples - Etiquetas Internas</h1>
    
    <div class="test-box">
        <h2>üß™ Teste da L√≥gica Passo a Passo</h2>
        <p>Este teste simula exatamente o que o c√≥digo deveria fazer:</p>
        <button onclick="testarLogica()">‚ñ∂Ô∏è Executar Teste</button>
        <div id="resultado" class="result" style="display: none;"></div>
    </div>

    <div class="test-box">
        <h2>üìã Instru√ß√µes</h2>
        <ol>
            <li>Clique no bot√£o acima para ver a simula√ß√£o</li>
            <li>Compare com o resultado da aplica√ß√£o real</li>
            <li>Configure na aplica√ß√£o: Base=1000, Qtd=3, C√≥pias=2, Tipo=Interna</li>
            <li>Verifique se os resultados s√£o iguais</li>
        </ol>
    </div>

    <script>
        const padLeft = (numStr, len) => (Array(len + 1).join('0') + numStr).slice(-len);

        function testarLogica() {
            const resultado = document.getElementById('resultado');
            resultado.style.display = 'block';
            
            // Par√¢metros exatos do teste
            const base = '1000';
            const qtd = 3;
            const copias = 2;
            const len = base.length;
            
            let log = '';
            log += `üß™ TESTE SIMPLES - L√ìGICA ETIQUETAS INTERNAS\\n`;
            log += `===============================================\\n\\n`;
            log += `Par√¢metros:\\n`;
            log += `- base: "${base}"\\n`;
            log += `- qtd: ${qtd}\\n`;
            log += `- copias: ${copias}\\n`;
            log += `- len: ${len}\\n\\n`;
            
            // Converter base para n√∫mero
            const baseNumber = parseInt(base, 10);
            log += `baseNumber = parseInt("${base}", 10) = ${baseNumber}\\n\\n`;
            
            let etiquetas = [];
            let totalEtiquetas = 0;
            
            // Loop principal
            log += `IN√çCIO DO LOOP PRINCIPAL:\\n`;
            log += `for (numeroSequencial = 0; numeroSequencial < ${qtd}; numeroSequencial++)\\n\\n`;
            
            for (let numeroSequencial = 0; numeroSequencial < qtd; numeroSequencial++) {
                log += `--- ITERA√á√ÉO ${numeroSequencial + 1} ---\\n`;
                log += `numeroSequencial = ${numeroSequencial}\\n`;
                
                // Calcular n√∫mero atual
                const numeroAtual = baseNumber + numeroSequencial;
                log += `numeroAtual = ${baseNumber} + ${numeroSequencial} = ${numeroAtual}\\n`;
                
                // Formatar com padding
                const numeroFormatado = padLeft(String(numeroAtual), len);
                log += `numeroFormatado = padLeft("${numeroAtual}", ${len}) = "${numeroFormatado}"\\n`;
                
                // √öltimos 4 d√≠gitos
                const numeroInterno = numeroFormatado.length >= 4 ? numeroFormatado.slice(-4) : numeroFormatado;
                log += `numeroInterno = "${numeroFormatado}".slice(-4) = "${numeroInterno}"\\n\\n`;
                
                // Loop de c√≥pias
                log += `  LOOP DE C√ìPIAS (${copias} c√≥pias):\\n`;
                for (let copia = 0; copia < copias; copia++) {
                    totalEtiquetas++;
                    etiquetas.push(numeroInterno);
                    log += `    C√≥pia ${copia + 1}: "${numeroInterno}" (etiqueta #${totalEtiquetas})\\n`;
                }
                log += `\\n`;
            }
            
            log += `===============================================\\n`;
            log += `RESULTADO FINAL:\\n`;
            log += `Total de etiquetas geradas: ${totalEtiquetas}\\n`;
            log += `Sequ√™ncia: [${etiquetas.join(', ')}]\\n\\n`;
            
            // Verifica√ß√£o
            const esperado = ['1000', '1000', '1001', '1001', '1002', '1002'];
            const correto = JSON.stringify(etiquetas) === JSON.stringify(esperado);
            
            if (correto) {
                log += `‚úÖ RESULTADO CORRETO!\\n`;
                log += `A l√≥gica est√° funcionando perfeitamente.\\n`;
                log += `Se a aplica√ß√£o real est√° dando resultado diferente,\\n`;
                log += `o problema pode estar em outro lugar (buildLabel, DOM, etc.)`;
            } else {
                log += `‚ùå PROBLEMA NA L√ìGICA!\\n`;
                log += `Esperado: [${esperado.join(', ')}]\\n`;
                log += `Obtido:   [${etiquetas.join(', ')}]\\n`;
            }
            
            resultado.textContent = log;
        }
    </script>

</body>
</html>