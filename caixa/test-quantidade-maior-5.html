<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - Quantidade Maior que 5</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .test-result { margin: 10px 0; padding: 10px; background: #f5f5f5; border-radius: 3px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        .warning { background: #fff3cd; color: #856404; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 3px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .debug-log { background: #f8f9fa; padding: 10px; border-left: 4px solid #007bff; margin: 10px 0; font-family: monospace; }
    </style>
</head>
<body>
    <h1>üß™ Teste - Problema com Quantidade > 5 (Somente Interna)</h1>
    
    <div class="test-section">
        <h2>üîç Problema Identificado</h2>
        <div class="test-result error">
            <p><strong>Sintoma:</strong> Erro aparece quando quantidade > 5 e "somente interna" est√° selecionada</p>
            <p><strong>Hip√≥teses poss√≠veis:</strong></p>
            <ul>
                <li>Problema na fun√ß√£o <code>padLeft</code> com n√∫meros maiores</li>
                <li>Erro no c√°lculo do <code>last4</code> (√∫ltimos 4 d√≠gitos)</li>
                <li>Problema de performance com muitas etiquetas</li>
                <li>Erro no loop de gera√ß√£o</li>
                <li>Problema com o delay/timeout</li>
            </ul>
        </div>
    </div>

    <div class="test-section">
        <h2>üß™ Cen√°rios de Teste Espec√≠ficos</h2>
        
        <div class="test-result info">
            <h3>Teste 1: Quantidade = 5 (Limite que funciona)</h3>
            <p><strong>Config:</strong> Base: 1000, Qtd: 5, C√≥pias: 2, Tipo: internal</p>
            <p><strong>Esperado:</strong> 10 etiquetas (1000, 1000, 1001, 1001, 1002, 1002, 1003, 1003, 1004, 1004)</p>
            <button onclick="testarLimite()">üß™ Testar Limite (5)</button>
        </div>

        <div class="test-result warning">
            <h3>Teste 2: Quantidade = 6 (Primeiro que falha)</h3>
            <p><strong>Config:</strong> Base: 1000, Qtd: 6, C√≥pias: 2, Tipo: internal</p>
            <p><strong>Esperado:</strong> 12 etiquetas</p>
            <button onclick="testarFalha()">üß™ Testar Falha (6)</button>
        </div>

        <div class="test-result warning">
            <h3>Teste 3: Quantidade = 10 (Maior)</h3>
            <p><strong>Config:</strong> Base: 1000, Qtd: 10, C√≥pias: 1, Tipo: internal</p>
            <p><strong>Esperado:</strong> 10 etiquetas</p>
            <button onclick="testarMaior()">üß™ Testar Maior (10)</button>
        </div>
    </div>

    <div class="test-section">
        <h2>üîß Debug Manual</h2>
        <div class="test-result info">
            <h3>Teste da Fun√ß√£o padLeft</h3>
            <button onclick="testarPadLeft()">üß™ Testar padLeft</button>
            <div id="padleft-result" class="debug-log" style="display: none;"></div>
        </div>

        <div class="test-result info">
            <h3>Teste do C√°lculo last4</h3>
            <button onclick="testarLast4()">üß™ Testar last4</button>
            <div id="last4-result" class="debug-log" style="display: none;"></div>
        </div>

        <div class="test-result info">
            <h3>Teste do Loop de Gera√ß√£o</h3>
            <button onclick="testarLoop()">üß™ Testar Loop</button>
            <div id="loop-result" class="debug-log" style="display: none;"></div>
        </div>
    </div>

    <div class="test-section">
        <h2>üìã Instru√ß√µes para Reproduzir o Erro</h2>
        <ol>
            <li>Abra a aplica√ß√£o caixa (index.html)</li>
            <li>Configure: Base: 1000, Quantidade: 6, C√≥pias: 2</li>
            <li>Selecione "Somente Interna"</li>
            <li>Abra o Console (F12) antes de clicar "Gerar"</li>
            <li>Clique em "Gerar" e observe o erro no console</li>
            <li>Anote a mensagem de erro exata</li>
        </ol>
    </div>

    <script>
        // Reproduzir as fun√ß√µes principais para teste
        const padLeft = (numStr, len) => (Array(len + 1).join('0') + numStr).slice(-len);

        function testarLimite() {
            alert('Configure na aplica√ß√£o:\\nBase: 1000\\nQuantidade: 5\\nC√≥pias: 2\\nTipo: Somente Interna\\n\\nEste deve funcionar normalmente.');
        }

        function testarFalha() {
            alert('Configure na aplica√ß√£o:\\nBase: 1000\\nQuantidade: 6\\nC√≥pias: 2\\nTipo: Somente Interna\\n\\nEste deve apresentar erro. Observe o console!');
        }

        function testarMaior() {
            alert('Configure na aplica√ß√£o:\\nBase: 1000\\nQuantidade: 10\\nC√≥pias: 1\\nTipo: Somente Interna\\n\\nTeste com quantidade ainda maior.');
        }

        function testarPadLeft() {
            const result = document.getElementById('padleft-result');
            result.style.display = 'block';
            
            let output = 'Teste da fun√ß√£o padLeft:\\n\\n';
            
            try {
                const base = '1000';
                const len = base.length;
                
                for (let i = 0; i < 10; i++) {
                    const atual = padLeft(String(parseInt(base, 10) + i), len);
                    output += `i=${i}: parseInt(${base}, 10) + ${i} = ${parseInt(base, 10) + i} -> padLeft = "${atual}"\\n`;
                }
                
                output += '\\n‚úÖ padLeft funcionou corretamente';
            } catch (e) {
                output += `\\n‚ùå ERRO na padLeft: ${e.message}`;
            }
            
            result.textContent = output;
        }

        function testarLast4() {
            const result = document.getElementById('last4-result');
            result.style.display = 'block';
            
            let output = 'Teste do c√°lculo last4:\\n\\n';
            
            try {
                const base = '1000';
                const len = base.length;
                
                for (let i = 0; i < 10; i++) {
                    const atual = padLeft(String(parseInt(base, 10) + i), len);
                    const last4 = atual.length >= 4 ? atual.slice(-4) : atual;
                    output += `i=${i}: atual="${atual}" -> last4="${last4}"\\n`;
                }
                
                output += '\\n‚úÖ last4 funcionou corretamente';
            } catch (e) {
                output += `\\n‚ùå ERRO no last4: ${e.message}`;
            }
            
            result.textContent = output;
        }

        function testarLoop() {
            const result = document.getElementById('loop-result');
            result.style.display = 'block';
            
            let output = 'Teste do loop de gera√ß√£o (simulado):\\n\\n';
            
            try {
                const base = '1000';
                const qtd = 6;
                const copias = 2;
                const len = base.length;
                let currentOperation = 0;
                
                output += `Configura√ß√£o: base=${base}, qtd=${qtd}, copias=${copias}, len=${len}\\n\\n`;
                
                for (let i = 0; i < qtd; i++) {
                    const atual = padLeft(String(parseInt(base, 10) + i), len);
                    const last4 = atual.length >= 4 ? atual.slice(-4) : atual;
                    
                    output += `N√∫mero ${i + 1}/${qtd}: ${atual} -> ${last4}\\n`;
                    
                    for (let k = 0; k < copias; k++) {
                        currentOperation++;
                        output += `  C√≥pia ${k + 1}/${copias}: ${last4} (opera√ß√£o ${currentOperation})\\n`;
                        
                        // Simular poss√≠vel problema
                        if (currentOperation > 10) {
                            output += `  ‚ö†Ô∏è Muitas opera√ß√µes, poss√≠vel problema de performance\\n`;
                        }
                    }
                }
                
                output += `\\n‚úÖ Loop simulado conclu√≠do: ${currentOperation} opera√ß√µes`;
            } catch (e) {
                output += `\\n‚ùå ERRO no loop: ${e.message}`;
            }
            
            result.textContent = output;
        }
    </script>

</body>
</html>